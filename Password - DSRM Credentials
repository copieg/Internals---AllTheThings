Password - DSRM Credentials

P.1 What It Is
	• Directory Services Restore Mode (DSRM) password: local “Administrator” password for restoring AD on a domain controller.
P.2 Why It Matters
	• If the domain is configured to sync the DSRM password with a domain user, attackers can retrieve it. Possibly leads to DC-level compromise.
P.3 How to Exploit (Step-by-Step)
	1. Check if DSRM is synced:

powershell
CopyEdit
reg query HKLM\SYSTEM\CurrentControlSet\Control\Lsa /v DsrmAdminLogonBehavior
	2. If it’s set to sync, you can often dump that user’s password or hash.
	3. Use that password on the DC in restore mode or if the account is privileged in AD.
	4. Defend
		○ Don’t sync DSRM password with domain accounts.
		○ Keep DSRM password secure/offline.
